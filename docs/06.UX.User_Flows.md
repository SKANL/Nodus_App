# 06. UX: User Flows & Optimistic UI

> **Status:** Draft
> **Key Principle:** "Don't Make Me Wait"

## 1. The "Optimistic" Philosophy

In Nodus, network latency can be 5 seconds or 5 hours. The UI **must never block** the user while waiting for a connection.

- **Wrong:** User taps "Submit" -> Spinner appears -> Waits 10s -> "Error".
- **Right:** User taps "Submit" -> Animation plays -> Form closes -> "Saved!" toast appears.

## 2. Visual Feedback States (The Traffic Light)

We use a persistent **Status Indicator** in the TopAppBar.

| Icon | Color | State       | Meaning                                                      |
| :--- | :---- | :---------- | :----------------------------------------------------------- |
| â˜ï¸   | Green | **Synced**  | All votes are on the Server/Cloud.                           |
| ðŸ’¾   | Amber | **Pending** | Votes are safely saved on the Phone, waiting for connection. |
| âš ï¸   | Red   | **Risk**    | Storage full or Bluetooth radio disabled.                    |

## 3. Core User Flows

### A. The "Judge Onboarding" Flow (Scan & Go)

Distinction: Judges use the **App**. Students use the **Web QR**.

1.  **Start:** Judge opens Nodus App.
2.  **Scan:** Taps "I am a Judge" -> Scans the **JUDGE ACCESS QR** (Projected on screen).
    - _Note:_ This is NOT the registration QR.
3.  **Authentication (The Gatekeeper):**
    - App prompt: "Enter Event Password".
    - User types: "Tesla2026" (Or whatever Admin set).
    - _Logic:_ App attempts to decrypt the QR payload.
      - Success: "Access Granted".
      - Fail: "Invalid Password".
4.  **Identity:**
    - App asks: "What is your name?" (e.g., "Dr. Brown").
    - App generates `Ed25519` Keys locally.
5.  **Feedback:**
    - _Immediate:_ "Welcome to Hackathon 2026".
    - _Background:_ App saves Keys + Server UUIDs. Ready to swarm.

### B. The "Voting" Flow (The Happy Path)

1.  **Trigger:** Judge scans a Project QR (e.g., "Team Alpha").
2.  **Load:** App loads schematic from Local SQLite (Instant).
3.  **Input:** Judge manipulates Sliders (1-10) and types comment.
4.  **Submit:**
    - Judge taps "Send Vote".
    - UI: Button turns Green with Checkmark.
    - Navigation: Popped back to Scanner immediately.
    - _Logic:_ Vote inserted to SQLite. Background Worker wakes up.

### C. The "Swarm" Feedback (Invisible)

The user **never** sees "Connecting to Bridge Node...". Use vague but reassuring language.

- _Notification:_ "Sending votes via nearby mesh..." (If stuck in Amber state for > 5 mins).

### D. The "Hero" State (Positive Reinforcement)

When the Firefly Protocol promotes a device to a **LINK** (Relay) node:

- **Visual:** A small "Glow" or "Firefly Icon" appears in the Status Bar.
- **Toast:** "You are helping 3 nearby judges connect! Keep the app open."
- **Why?** Encourages the user (especially on iOS) to keep the screen active, which ensures the relay stays alive.

## 4. Error Handling

- **Duplicate Scan:** If Judge scans "Team Alpha" again -> Show "Edit Vote" screen, not a new blank form.
- **Bluetooth Off:** Aggressive Alert. "Nodus requires Bluetooth. Enable now?"

### E. The "Mule Mode" (Fail-Safe)

**Trigger:** App has `Pending` votes and has not seen Server or a Firefly for > 10 minutes.

1.  **Alert:** Status Bar turns **PURPLE** (Mule Mode).
2.  **Notification:** "Network Unreachable. Data saved locally."
3.  **Instruction:** "Walk to the Admin Desk to sync."
4.  **Auto-Recovery:**
    - When the device detects the Server Signal > -60dBm (Very Close).
    - Status turns Green.
    - Upload starts automatically (High bandwidth burst).
    - **Toast:** "Sync Complete! Thanks for walking."
